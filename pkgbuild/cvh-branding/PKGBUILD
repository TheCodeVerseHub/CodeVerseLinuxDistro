# Maintainer: CVH Linux Team
pkgname=cvh-branding
pkgver=0.1.0
pkgrel=1
pkgdesc="CVH Linux branding, GRUB theme, and default configurations"
arch=('any')
url="https://github.com/codeversehub/cvh-linux"
license=('GPL3')
depends=()
source=()

_cvh_root="/home/ofekb/codeversedistro/CodeVerseLinuxDistro"

package() {
    # MOTD - welcome message
    install -Dm644 /dev/stdin "$pkgdir/etc/motd" <<'MOTDEOF'
Welcome to CVH Linux!

Quick Start:
  - Mod+Return    Open terminal
  - Mod+D         Application launcher
  - Mod+1-9       Switch workspaces
  - Mod+Shift+Q   Close window
  - Mod+Shift+E   Exit compositor

For more info: https://github.com/codeversehub/cvh-linux
MOTDEOF

    # CVH Linux info file
    install -Dm644 /dev/stdin "$pkgdir/usr/share/cvh-linux/info" <<'INFOEOF'
NAME="CVH Linux"
PRETTY_NAME="CVH Linux"
ID=cvh
VERSION_ID=0.1
HOME_URL="https://codeversehub.dev"
DOCUMENTATION_URL="https://github.com/codeversehub/cvh-linux"
INFOEOF

    # Install GRUB theme (Tela)
    install -dm755 "$pkgdir/usr/share/cvh-linux/grub-theme/tela"
    install -dm755 "$pkgdir/usr/share/cvh-linux/grub-theme/tela/icons"

    # Copy theme.txt
    if [[ -f "$_cvh_root/configs/grub/themes/tela/theme.txt" ]]; then
        install -Dm644 "$_cvh_root/configs/grub/themes/tela/theme.txt" \
            "$pkgdir/usr/share/cvh-linux/grub-theme/tela/theme.txt"
    fi

    # Copy background (Tela uses .jpg)
    if [[ -f "$_cvh_root/configs/grub/themes/tela/background.jpg" ]]; then
        install -Dm644 "$_cvh_root/configs/grub/themes/tela/background.jpg" \
            "$pkgdir/usr/share/cvh-linux/grub-theme/tela/background.jpg"
    fi

    # Copy fonts (REQUIRED for GRUB text rendering)
    for font in "$_cvh_root/configs/grub/themes/tela"/*.pf2; do
        if [[ -f "$font" ]]; then
            install -Dm644 "$font" "$pkgdir/usr/share/cvh-linux/grub-theme/tela/$(basename $font)"
        fi
    done

    # Copy all theme assets (select boxes, progress bars, etc.)
    for asset in "$_cvh_root/configs/grub/themes/tela"/*.png; do
        if [[ -f "$asset" ]]; then
            install -Dm644 "$asset" "$pkgdir/usr/share/cvh-linux/grub-theme/tela/$(basename $asset)"
        fi
    done

    # Copy icons
    for icon in "$_cvh_root/configs/grub/themes/tela/icons"/*.png; do
        if [[ -f "$icon" ]]; then
            install -Dm644 "$icon" "$pkgdir/usr/share/cvh-linux/grub-theme/tela/icons/$(basename $icon)"
        fi
    done
}
